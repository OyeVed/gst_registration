<!DOCTYPE html>
<html lang="en">

<head>
    <title>Gst Form - GST</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Main CSS-->
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <!-- Font-icon css-->
    <link rel="stylesheet" type="text/css"
        href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- axios -->
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>

<body class="app sidebar-mini">
    <!-- NOTE: START: -->
    <!-- loader -->
    <div class="overlay"></div>
    <div class="spanner">
        <div class="loader"></div>
    </div>
    <!-- END: -->
    <!-- Navbar-->
    <header class="app-header"><a class="app-header__logo" href="index.html">GST</a>
        <!-- Sidebar toggle button--><a class="app-sidebar__toggle" href="#" data-toggle="sidebar"
            aria-label="Hide Sidebar"></a>
        <!-- Navbar Right Menu-->
        <ul class="app-nav">
            <!-- User Menu-->
            <li class="dropdown"><a class="app-nav__item" href="#" data-toggle="dropdown"
                    aria-label="Open Profile Menu"><i class="fa fa-user fa-lg"></i></a>
                <ul class="dropdown-menu settings-menu dropdown-menu-right">
                    <li><a class="dropdown-item" href="page-user.html"><i class="fa fa-cog fa-lg"></i> Settings</a></li>
                    <li><a class="dropdown-item" href="page-user.html"><i class="fa fa-user fa-lg"></i> Profile</a></li>
                    <li><a class="dropdown-item" href="page-login.html"><i class="fa fa-sign-out fa-lg"></i> Logout</a>
                    </li>
                </ul>
            </li>
        </ul>
    </header>
    <!-- Sidebar menu-->
    <div class="app-sidebar__overlay" data-toggle="sidebar"></div>
    <aside class="app-sidebar">
        <div class="app-sidebar__user">
            <img class="app-sidebar__user-avatar"
                src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAM1BMVEXk5ueutLfn6eqrsbTp6+zg4uOwtrnJzc/j5earsbW0uby4vcDQ09XGyszU19jd3+G/xMamCvwDAAAFLklEQVR4nO2d2bLbIAxAbYE3sDH//7WFbPfexG4MiCAcnWmnrzkjIRaD2jQMwzAMwzAMwzAMwzAMwzAMwzAMwzAMwzAMwzAMw5wQkHJczewxZh2lhNK/CBOQo1n0JIT74/H/qMV0Z7GU3aCcVPuEE1XDCtVLAhgtpme7H0s1N1U7QjO0L8F7llzGeh1hEG/8Lo7TUmmuSrOfns9xnGXpXxsONPpA/B6OqqstjC6Ax/0ujkNdYQQbKNi2k64qiiEZ+ohi35X+2YcZw/WujmslYewiAliVYrxgJYrdwUmwXsU+RdApUi83oNIE27YvrfB/ZPg8+BJETXnqh9CVzBbTQHgojgiCvtqU9thFJg/CKz3VIMKMEkIXxIWqIpIg2SkjYj+xC816mrJae2aiWGykxRNsW0UwiJghJDljYI5CD8GRiCtIsJxizYUPQ2pzItZy5pcisTRdk/a9m4amtNNfBuQkdVhSaYqfpNTSFGfb9GRIakrE2Pm+GFLaCQPqiu0OpWP+HMPQQcgQMiQprWXNmsVwIjQjYi/ZrhAqNTCgr2gu0Jnz85RSSjso0HkMFZ0YZjKkc26a/jlmh9JiDyDxi9oeorTYAzZkwwoMz19pzj9bnH/GP/+qbchjSGflneWYhtTuKdMOmNKZcJ5TjInQKcYXnESd/jQxy0ENpULTNGOGgxpap/oyw9pbUAqhfx2Dbkhovvfgz4iUzoM9+GlK6/Mh4q29hyC1mwro30hpVVLPF9wYQr71RazOeM5/cw81iBRD+A03aM9/C/obbrKjbYSpCmIVG3qT/Q8oeUo3Rz0IL7vI1tEbCB9pSiu8I/aV8x3Kg/BGWrWp4ZVs0nZfmAoEG4h/61yHYIJiFSl6Q0Vk6tTW1N8kYp8hdOkfHYYMXd2Qft+8CYwqYDSKvqIh+MCF8Wgca2u/cwdgeW3TtuVn6+1oBs3yLo5C2JpK6CvQzGpfUkz9UG/87gCsi5o2LIXolxN0FbwAsjOLEr+YJmXn7iR6N0BCt5p5cMxm7eAsfS+/CACQf4CTpKjzgkvr2cVarVTf96372yut7XLJ1sa7lv6VcfgYrWaxqr3Wlo1S6pvStr22sxOtTNPLzdY3nj20bPP+ejFdJYkLsjGLdtPBEbe/mr2bQKiXWJDroA+vtzc0p9aahuwqHMDYrQEXHEw9jwQl3drMpts9JBU1SdktPe5FBRdJQ6bwXBpa57ib2A8kukQDzMjh++Uo7Fo6Wd02Pkf4fknqoo4HtvAIjsqUcjx6DIPgWCaOML9rKI/oqD9/lgNrn+eF+p7j8tnzHBiR7+kdUGw/+V1Kzkc75mMy6U+FMaxjPibiM1U1uGM+puInHpmALZCgP4pt7i840MV8+0R1zPsRB6UTcqpizncYwZ89syDydfyWCwXB1l8/zRNGWbTG/GHKUm9AkxHMc/EGSk3z2+ArEhPEV5TUBLEvUGFcjEUH80J/jveTGOAJEljJbILWGQT3zRYiwuKsUXN1EEJAzBhRJFll7mBUG7KD8EqPkKekBREaL8hMDZLQSG6AQjtHPYmvTQnX0TtpC1SYCe2YdkkyLP3jj5BSbKiuR585eQhTgoje6yIb0Yb0C+mV6EYvebqw5SDy2WmubogZiF2AVxPC2FpDf8H2Q9QWo6IkjUxTWVEI3WY/wrCeSuqJ+eRWzXR/JXwgVjUMozbCOfoEZiSiKVGepqv5CJ8RyR4D7xBeamqa7z3BJ/z17JxuBPdv93d/a2Ki878MMAzDMAzDMAzDMAzDMF/KP09VUmxBAiI3AAAAAElFTkSuQmCC"
                alt="User Image">
            <p class="app-sidebar__user-name">John Doe</p>
            <p class="app-sidebar__user-designation">Admin</p>
        </div>
        <ul class="app-menu">
            <li><a class="app-menu__item" href="dashboard.html"><i class="app-menu__icon fa fa-dashboard"></i><span
                        class="app-menu__label">Dashboard</span></a>
            </li>
            <li><a class="app-menu__item" href="payments.html"><i class="app-menu__icon fa fa-dashboard"></i><span
                        class="app-menu__label">Payments</span></a>
            </li>
        </ul>
    </aside>
    <main class="app-content">
        <div class="app-title">
            <div>
                <h1><i class="fa fa-file-text" aria-hidden="true"></i> GST Form</h1>
            </div>
        </div>
        <div class="tile p-5">
            <h3 class="tile-title">Your Form</h3>
            <div class="tile-body">
                <form id="gst_form">

                </form>
            </div>
            <div class="tile-footer">
                <button onclick="submitForm()" class="btn btn-primary" type="button"><i
                        class="fa fa-fw fa-lg fa-check-circle"></i>Register</button>&nbsp;&nbsp;&nbsp;<a
                    class="btn btn-secondary" href="#"><i class="fa fa-fw fa-lg fa-times-circle"></i>Cancel</a>
            </div>
        </div>
    </main>
    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/main.js"></script>
    <script src="js/plugins/pace.min.js"></script>
    <script type="text/javascript" src="js/plugins/chart.js"></script>
    <script src="js/globalFunction.js"></script>
    <script type="text/javascript">
        let fetchedFiels = [
            {
                "field_id": "1",
                "field_title": "Full Name",
                "field_type": "Text",
                "field_required": true,
                "field_associated_to": [6]
            },
            {
                "field_id": "6",
                "field_title": "Gender",
                "field_type": "Radio-Button",
                "field_required": true,
                "field_associated_to": null,
                "field_values": [['Male'], ['Female']]
            },
            {
                "field_id": "2",
                "field_title": "Age",
                "field_type": "Text",
                "field_required": true,
                "field_associated_to": null
            },
            {
                "field_id": "3",
                "field_title": "I have a",
                "field_type": "Radio-Button",
                "field_required": true,
                "field_associated_to": null,
                "field_values": [['Permanent Account Number(PAN)', '7'], ['Do not have a Permanent Account Number(PAN)', '8']]
            },
            {
                "field_id": "4",
                "field_title": "Are you a Regular Tax Payer",
                "field_type": "Toggle",
                "field_required": true,
                "field_associated_to": null,
                "field_values": [['No'], ['Yes', '15']]
            },
            {
                "field_id": "5",
                "field_title": "I am a",
                "field_type": "Dropdown",
                "field_required": false,
                "field_associated_to": null,
                "field_values": [['Tax Deductor', '2', '2'], ['Tax Collector', '2'], ['Tax Payer']]
            }
        ]
        function setFields(container_id_n, nowFields) {
            console.log(container_id_n, nowFields)
            let container_id = document.getElementById(container_id_n)
            container_id.innerHTML = ''
            for (let i = 0; i < nowFields.length; i++) {
                const element = nowFields[i];
                switch (element?.field_type) {
                    case 'Text':
                        container_id.innerHTML = container_id.innerHTML +
                            `
                            <div class="form-group" >
                            <label class="control-label">${element?.field_title}</label>
                            <input class="form-control" id='${element?.field_type}_${element?.field_id}' type="text" placeholder='${element?.field_title?.toLocaleLowerCase()}'>
                            </div>
                            `
                        break;
                    case 'Radio-Button':
                        container_id.innerHTML = container_id.innerHTML +
                            `<div class="form-group" id='${element?.field_type}_${element?.field_id}'>
                             <label class="control-label">${element?.field_title}</label>
                             ${element?.field_values?.map(fieldValue => (
                                `<div class="form-check">
                                <label class="form-check-label">
                                   <input class="form-check-input" type="radio" name='${element?.field_type}_${element?.field_id}'>${fieldValue[0]}
                                </label>
                            </div>`
                            )).join('')}
                        </div>
                        `
                        break;
                    case 'Toggle':
                        container_id.innerHTML = container_id.innerHTML +
                            `
                    <div class="form-group" id='${element?.field_type}_${element?.field_id}'>
                    <label class="control-label">${element?.field_title}</label>
                    <div class="toggle-flip">
                         <label>
                     <input type="checkbox"><span class="flip-indecator" data-toggle-on='${element?.field_values[1][0]}' data-toggle-off='${element?.field_values[0][0]}'></span>
                     </label>
                     </div>
                    </div>
                    `
                        break;
                    case 'Dropdown':
                        container_id.innerHTML = container_id.innerHTML +
                            `
                        <div class="form-group">
                             <label for='${element?.field_type}_${element?.field_id}'>${element?.field_title}</label>
                            <select onchange="updateFieldValueAssociateDropDown(${element?.field_id})" class="form-control" id='${element?.field_type}_${element?.field_id}'>
                                <option value="" >-Select One - </option>
                                ${element?.field_values?.map(fieldValue => (
                                `<option value='${fieldValue}'>${fieldValue[0]}</option>`
                            )).join('')}
                            </select>
                        </div>
                        <div id="field_value_associate_${element?.field_id}" ></div>
                        `
                    default:
                        break;
                }
            }
        }
        setFields('gst_form', fetchedFiels)
        function updateFieldValueAssociateDropDown(id) {
            let selectDropDown = document.getElementById(`Dropdown_${id}`);
            let arrOfData = selectDropDown.value.split(',');
            let theRemovedElement = arrOfData.shift();
            let arrOfNum = arrOfData.map(str => {
                return Number(str);
            });
            if (arrOfNum?.length > 0) {
                startLoader()
                axiosInstance.post('fetch_dependencies', {
                    "fetch_field": arrOfNum
                }).then((response) => {
                    console.log(response)
                    let nowGG1 = [
                        {
                            "field_id": "1",
                            "field_title": "Full Name",
                            "field_type": "Text",
                            "field_required": true,
                            "field_associated_to": "[6]"
                        },
                        {
                            "field_id": "6",
                            "field_title": "Gender",
                            "field_type": "Radio-Button",
                            "field_required": true,
                            "field_associated_to": null,
                            "field_values": [['Male'], ['Female']]
                        },
                    ]
                    let nowGG2 = [
                        {
                            "field_id": "6",
                            "field_title": "Gender",
                            "field_type": "Radio-Button",
                            "field_required": true,
                            "field_associated_to": null,
                            "field_values": [['Male'], ['Female']]
                        },
                    ]
                    setFields(`field_value_associate_${id}`, arrOfNum?.length > 1 ? nowGG1 : nowGG2)

                    endLoader()
                }, (error) => {
                    console.log('error', error);
                    endLoader()
                })
            } else {
                document.getElementById(`field_value_associate_${id}`).innerHTML = ''
            }
        }
        function submitForm() {
            for (let i = 0; i < fetchedFiels.length; i++) {
                const element = fetchedFiels[i];
                if (element?.field_required) {
                    let nowValue = document.getElementById(`${element?.field_type}_${element?.field_id}`).value
                    console.log(nowValue)
                    if (nowValue == "" || nowValue == null || nowValue == undefined) {
                        alert(`Please enter ${element?.field_title}`)
                        return;
                    }
                }
            }
        }
    </script>
</body>

</html>